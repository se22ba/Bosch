<!doctype html>
<html lang="es">
<head>
  <meta charset="utf-8" />
  <title>VRM Multi-Dashboard</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <style>
    body{font-family: system-ui,Segoe UI,Roboto,Arial,sans-serif;background:#f6f7fb;color:#111;margin:0}
    header{padding:18px 20px;font-weight:700;font-size:24px}
    .wrap{max-width:1100px;margin:0 auto;padding:0 16px 50px}
    .card{background:#fff;border-radius:14px;box-shadow:0 2px 10px rgba(0,0,0,.06);padding:16px;margin-bottom:16px}
    .grid{display:grid;grid-template-columns:1fr 1fr 1fr;gap:12px}
    .grid-4{display:grid;grid-template-columns:repeat(4,minmax(0,1fr));gap:12px}
    textarea{width:100%;min-height:90px;resize:vertical;padding:8px;border:1px solid #ddd;border-radius:10px;font-family:ui-monospace,Consolas,monospace}
    input[type="text"],input[type="password"]{width:100%;padding:8px;border:1px solid #ddd;border-radius:10px}
    button{padding:10px 16px;border:0;border-radius:12px;background:#111;color:#fff;font-weight:600;cursor:pointer}
    .kpi{padding:14px;border-radius:12px;background:#fafbfd;border:1px solid #eef;display:flex;flex-direction:column;gap:8px}
    .kpi .big{font-size:28px;font-weight:800}
    table{width:100%;border-collapse:collapse}
    th,td{border-bottom:1px solid #eee;padding:8px;text-align:left;font-size:14px}
    .muted{color:#777}
    .ok{color:#1a7f37;font-weight:700}
    .warn{color:#a76e00;font-weight:700}
    .fail{color:#b42318;font-weight:700}
  </style>
</head>
<body>
  <header>VRM Multi-Dashboard</header>
  <div class="wrap">
    <div class="card">
      <div class="grid">
        <div>
          <div><b>URLs VRM Monitor / Status (una por línea)</b></div>
          <textarea id="vrmList" placeholder="https://172.20.67.94&#10;https://172.20.65.85"></textarea>
          <div class="muted">Tip: pegá la base (con o sin /vrmcockpit). El proxy ajusta solo.</div>
        </div>
        <div>
          <div><b>Usuario (opcional)</b></div>
          <input id="vrmUser" type="text" placeholder="readonly" />
        </div>
        <div>
          <div><b>Contraseña (opcional)</b></div>
          <input id="vrmPass" type="password" placeholder="••••••••" />
        </div>
      </div>
      <div style="display:flex;gap:10px;align-items:center;margin-top:10px">
        <button id="btnConsultar">Consultar</button>
        <div class="muted" id="hintStatus">OK (0 cámaras, errores: 0)</div>
      </div>
    </div>

    <div class="grid-4">
      <div class="kpi">
        <div>Cámaras sin conexión</div>
        <div class="big" id="cntOffline">0</div>
        <div class="muted">Sin stream detectable</div>
      </div>
      <div class="kpi">
        <div>Cámaras operativas</div>
        <div class="big" id="cntOnline">0</div>
        <div class="muted">Con stream y respuesta</div>
      </div>
      <div class="kpi">
        <div>Cámaras grabando</div>
        <div class="big" id="cntRecording">0</div>
        <div class="muted">Bloques asignados + avance</div>
      </div>
      <div class="kpi">
        <div>Cámaras sin grabación</div>
        <div class="big" id="cntNoRecording">0</div>
        <div class="muted">Sin bloques o sin avance</div>
      </div>
    </div>

    <div class="card">
      <div style="font-weight:700;margin-bottom:8px">Detalle</div>
      <table>
        <thead>
          <tr>
            <th>VRM</th><th>Nombre</th><th>Dirección</th><th>Estado</th><th>Grabación</th><th>Notas</th>
          </tr>
        </thead>
        <tbody id="tblBody"></tbody>
      </table>
    </div>
  </div>

  <!-- ¡Importante!: cargar el decoder antes del app -->
  <script src="rcp-decoder.js"></script>
  <script src="app.js"></script>
</body>
</html>